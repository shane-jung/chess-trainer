{"ast":null,"code":"import pieces from \"./pieces\";\nexport const calculateLegalMoves = (board, color) => {\n  console.log(board, color);\n  const selector = color === \"w\" ? 0b10000 : 0b1000;\n  console.log(\"Selector: \", selector);\n  const pieces = board.map((piece, index) => piece & selector ? index : null).filter(piece => piece !== null);\n  console.log(pieces);\n  const moves = pieces.map(element => {\n    return calculateLegalMovesForPiece(board, element);\n  }).reduce((acc, val) => acc.concat(val), []);\n  return moves;\n};\nconst calculateLegalMovesForPiece = (board, index) => {\n  const type = Object.keys(pieces).find(key => pieces[key] === board[index]);\n  switch (type.toLowerCase()) {\n    case \"p\":\n      return calculatePawnMoves(board, index);\n    case \"r\":\n      return calculateRookMoves(board, index);\n    case \"n\":\n      return calculateKnightMoves(board, index);\n    case \"b\":\n      return calculateBishopMoves(board, index);\n    case \"q\":\n      return calculateQueenMoves(board, index);\n    case \"k\":\n      return calculateKingMoves(board, index);\n    default:\n      return [];\n  }\n};\nfunction isOccupied(board, index) {\n  return board[index] !== 0;\n}\nfunction isSameColor(board, index1, index2) {\n  return board[index1] & board[index2] & 0b10000 || board[index1] & board[index2] & 0b1000;\n}\nfunction calculatePawnMoves(board, index) {\n  let rank = Math.floor(index / 8);\n  let file = index % 8;\n  const candidateMoves = [];\n  const color = board[index] & 0b10000 ? \"w\" : \"b\";\n  if (color === \"b\") {\n    if (!isOccupied(board, index - 8)) candidateMoves.push(index - 8);\n    if (rank === 6 && !isOccupied(board, index - 16)) candidateMoves.push(index - 16);\n    if (file > 0 && isOccupied(board, index - 9)) candidateMoves.push(index - 9);\n    if (file < 7 && isOccupied(board, index - 7)) candidateMoves.push(index - 7);\n  } else {\n    if (!isOccupied(board, index + 8)) candidateMoves.push(index + 8);\n    if (rank === 1 && !isOccupied(board, index + 16)) candidateMoves.push(index + 16);\n    if (file > 0 && isOccupied(board, index + 7)) candidateMoves.push(index + 7);\n    if (file < 7 && isOccupied(board, index + 9)) candidateMoves.push(index + 9);\n  }\n  const legalMoves = candidateMoves.filter(move => !isSameColor(board, index, move));\n  return legalMoves;\n}\nfunction calculateRookMoves(board, index) {\n  const candidateMoves = [];\n  const rank = Math.floor(index / 8);\n  const file = index % 8;\n  for (let i = -1; i >= -file; i--) {\n    if (isOccupied(board, index + i)) {\n      candidateMoves.push(index + i);\n      break;\n    }\n    candidateMoves.push(index + i);\n  }\n  for (let i = 1; i < 8 - file; i++) {\n    if (isOccupied(board, index + i)) {\n      candidateMoves.push(index + i);\n      break;\n    }\n    candidateMoves.push(index + i);\n  }\n  for (let i = -1; i >= -rank; i--) {\n    if (isOccupied(board, index + 8 * i)) {\n      candidateMoves.push(index + 8 * i);\n      break;\n    }\n    candidateMoves.push(index + 8 * i);\n  }\n  for (let i = 1; i < 8 - rank; i++) {\n    if (isOccupied(board, index + 8 * i)) {\n      candidateMoves.push(index + 8 * i);\n      break;\n    }\n    candidateMoves.push(index + 8 * i);\n  }\n  const legalMoves = candidateMoves.filter(move => !isSameColor(board, index, move));\n  // console.log(legalMoves);\n  return legalMoves;\n}\nfunction calculateBishopMoves(board, index) {\n  const candidateMoves = [];\n  const rank = Math.floor(index / 8);\n  const file = index % 8;\n  for (let i = -1; i >= -Math.min(file, rank); i--) {\n    //up and left\n    candidateMoves.push(index + i + i * 8);\n    if (isOccupied(board, index + i + i * 8)) break;\n  }\n  for (let i = 1; i < Math.min(8 - rank, 8 - file); i++) {\n    //down and right\n    candidateMoves.push(index + i + i * 8);\n    if (isOccupied(board, index + i + i * 8)) break;\n  }\n  for (let i = -1; i >= 1 - Math.min(8 - file, 1 + rank); i--) {\n    //up and right\n    candidateMoves.push(index - i + i * 8);\n    if (isOccupied(board, index - i + i * 8)) break;\n  }\n  for (let i = 1; i < Math.min(file, 8 - rank); i++) {\n    //down and left\n    candidateMoves.push(index - i + i * 8);\n    if (isOccupied(board, index - i + i * 8)) break;\n  }\n  const legalMoves = candidateMoves.filter(move => !isSameColor(board, index, move));\n  return legalMoves;\n}\nfunction calculateKnightMoves(board, index) {\n  let candidateMoves = [];\n  const rank = Math.floor(index / 8);\n  const file = index % 8;\n  if (file > 0) {\n    if (rank > 1) candidateMoves.push(index - 17);\n    if (rank < 6) candidateMoves.push(index + 15);\n  }\n  if (file > 1) {\n    if (rank > 0) candidateMoves.push(index - 10);\n    if (rank < 7) candidateMoves.push(index + 6);\n  }\n  if (file < 6) {\n    if (rank > 0) candidateMoves.push(index - 6);\n    if (rank < 7) candidateMoves.push(index + 10);\n  }\n  if (file < 7) {\n    if (rank > 1) candidateMoves.push(index - 15);\n    if (rank < 6) candidateMoves.push(index + 17);\n  }\n  let legalMoves = candidateMoves.filter(move => !isSameColor(board, index, move));\n  console.log(index, legalMoves);\n  return legalMoves;\n}\nfunction calculateQueenMoves(board, index) {\n  return [...calculateBishopMoves(board, index), ...calculateRookMoves(board, index)];\n}\nfunction calculateKingMoves(board, index) {\n  let candidateMoves = [];\n  const rank = Math.floor(index / 8);\n  const file = index % 8;\n  const white = board[index] & 0b10000;\n  if (file > 0) {\n    candidateMoves.push(index - 1);\n    if (rank > 0) candidateMoves.push(index - 9);\n    if (rank < 7) candidateMoves.push(index + 7);\n  }\n  if (file < 7) {\n    candidateMoves.push(index + 1);\n    if (rank > 0) candidateMoves.push(index - 7);\n    if (rank < 7) candidateMoves.push(index + 9);\n  }\n  if (rank > 0) candidateMoves.push(index - 8);\n  if (rank < 7) candidateMoves.push(index + 8);\n  const legalMoves = candidateMoves.filter(move => !isSameColor(board, index, move));\n  return legalMoves;\n}\nexport function kingSquares(board, index) {\n  const white = board[index] & 0b1000;\n  const candidateMoves = calculateKingMoves(board, index);\n  console.log(candidateMoves);\n  const legalMoves = candidateMoves.filter(move => {\n    const newBoard = [...board];\n    newBoard[move] = newBoard[index];\n    newBoard[index] = 0;\n    return calculateLegalMoves(newBoard, white ? \"w\" : \"b\").includes(move);\n  });\n  console.log(legalMoves);\n  return;\n  // // console.log(white, legalMoves);\n  // const oppositeColorLegalMoves = calculateLegalMoves(board, white ? \"w\": \"b\"); \n  // // console.log(\"OPPOSITE COLOR MOVES: \", oppositeColorLegalMoves);\n  // // console.log(oppositeColorLegalMoves, legalMoves);\n  // const legalMovesNotInCheck = legalMoves.filter(move => !oppositeColorLegalMoves.includes(move));\n  // console.log(\"LEgal moves: \", legalMovesNotInCheck);\n  // // return legalMovesNotInCheck;\n}\n\nexport default calculateLegalMovesForPiece;","map":{"version":3,"names":["pieces","calculateLegalMoves","board","color","console","log","selector","map","piece","index","filter","moves","element","calculateLegalMovesForPiece","reduce","acc","val","concat","type","Object","keys","find","key","toLowerCase","calculatePawnMoves","calculateRookMoves","calculateKnightMoves","calculateBishopMoves","calculateQueenMoves","calculateKingMoves","isOccupied","isSameColor","index1","index2","rank","Math","floor","file","candidateMoves","push","legalMoves","move","i","min","white","kingSquares","newBoard","includes"],"sources":["C:/Users/shane/Documents/Projects/chess-trainer/src/calculateMoves.js"],"sourcesContent":["import pieces from \"./pieces\";\r\n\r\nexport const calculateLegalMoves = (board, color) => {\r\n  console.log(board, color);\r\n  const selector = color === \"w\" ? 0b10000 : 0b1000;\r\n  console.log(\"Selector: \", selector);\r\n  const pieces = board.map((piece, index) => (piece & selector) ? index : null).filter((piece) => piece !== null);\r\n  console.log(pieces);\r\n  const moves = pieces.map(element => {\r\n    return calculateLegalMovesForPiece(board, element);\r\n  }).reduce((acc, val) => acc.concat(val), []);\r\n  \r\n  return moves;\r\n}\r\n\r\nconst calculateLegalMovesForPiece= (board, index) => {\r\n  const type = Object.keys(pieces).find((key) => pieces[key] === board[index]);\r\n  switch (type.toLowerCase()) {\r\n    case \"p\":\r\n      return calculatePawnMoves(board, index);\r\n    case \"r\":\r\n      return calculateRookMoves(board, index);\r\n    case \"n\":\r\n      return calculateKnightMoves(board, index);\r\n    case \"b\":\r\n      return calculateBishopMoves(board, index);\r\n\r\n    case \"q\":\r\n      return calculateQueenMoves(board, index);\r\n    case \"k\":\r\n      return calculateKingMoves(board, index);\r\n    default:\r\n      return [];\r\n  }\r\n};\r\n\r\nfunction isOccupied(board, index) {\r\n  return board[index] !== 0;\r\n}\r\n\r\nfunction isSameColor(board, index1, index2) {\r\n  return (\r\n    board[index1] & board[index2] & 0b10000 ||\r\n    board[index1] & board[index2] & 0b1000\r\n  );\r\n}\r\n\r\nfunction calculatePawnMoves(board, index) {\r\n  let rank = Math.floor(index / 8);\r\n  let file = index % 8;\r\n  const candidateMoves = [];\r\n  const color = board[index] & 0b10000 ? \"w\" : \"b\";\r\n  if (color === \"b\") {\r\n    if (!isOccupied(board, index - 8)) candidateMoves.push(index - 8);\r\n    if (rank === 6 && !isOccupied(board, index - 16))\r\n      candidateMoves.push(index - 16);\r\n    if (file > 0 && isOccupied(board, index - 9))\r\n      candidateMoves.push(index - 9);\r\n    if (file < 7 && isOccupied(board, index - 7))\r\n      candidateMoves.push(index - 7);\r\n  } else {\r\n    if (!isOccupied(board, index + 8)) candidateMoves.push(index + 8);\r\n    if (rank === 1 && !isOccupied(board, index + 16))\r\n      candidateMoves.push(index + 16);\r\n    if (file > 0 && isOccupied(board, index + 7))\r\n      candidateMoves.push(index + 7);\r\n    if (file < 7 && isOccupied(board, index + 9))\r\n      candidateMoves.push(index + 9);\r\n  }\r\n  const legalMoves = candidateMoves.filter(\r\n    (move) => !isSameColor(board, index, move)\r\n  );\r\n\r\n  return legalMoves;\r\n}\r\n\r\nfunction calculateRookMoves(board, index) {\r\n  const candidateMoves = [];\r\n  const rank = Math.floor(index / 8);\r\n  const file = index % 8;\r\n  for (let i = -1; i >= -file; i--) {\r\n    if (isOccupied(board, index + i)) {\r\n      candidateMoves.push(index + i);\r\n      break;\r\n    }\r\n    candidateMoves.push(index + i);\r\n  }\r\n  for (let i = 1; i < 8 - file; i++) {\r\n    if (isOccupied(board, index + i)) {\r\n      candidateMoves.push(index + i);\r\n      break;\r\n    }\r\n    candidateMoves.push(index + i);\r\n  }\r\n  for (let i = -1; i >= -rank; i--) {\r\n    if (isOccupied(board, index + 8 * i)) {\r\n      candidateMoves.push(index + 8 * i);\r\n      break;\r\n    }\r\n    candidateMoves.push(index + 8 * i);\r\n  }\r\n  for (let i = 1; i < 8 - rank; i++) {\r\n    if (isOccupied(board, index + 8 * i)) {\r\n      candidateMoves.push(index + 8 * i);\r\n      break;\r\n    }\r\n    candidateMoves.push(index + 8 * i);\r\n  }\r\n  const legalMoves = candidateMoves.filter(\r\n    (move) => !isSameColor(board, index, move)\r\n  );\r\n  // console.log(legalMoves);\r\n  return legalMoves;\r\n}\r\n\r\nfunction calculateBishopMoves(board, index) {\r\n  const candidateMoves = [];\r\n  const rank = Math.floor(index / 8);\r\n  const file = index % 8;\r\n  for (let i = -1; i >= -Math.min(file, rank); i--) {\r\n    //up and left\r\n    candidateMoves.push(index + i + i * 8);\r\n    if (isOccupied(board, index + i + i * 8)) break;\r\n  }\r\n  for (let i = 1; i < Math.min(8 - rank, 8 - file); i++) {\r\n    //down and right\r\n    candidateMoves.push(index + i + i * 8);\r\n    if (isOccupied(board, index + i + i * 8)) break;\r\n  }\r\n  for (let i = -1; i >= 1 - Math.min(8 - file, 1 + rank); i--) {\r\n    //up and right\r\n    candidateMoves.push(index - i + i * 8);\r\n    if (isOccupied(board, index - i + i * 8)) break;\r\n  }\r\n  for (let i = 1; i < Math.min(file, 8-rank); i++) {\r\n    //down and left\r\n    candidateMoves.push(index - i + i * 8);\r\n    if (isOccupied(board, index - i + i * 8)) break;\r\n  }\r\n  const legalMoves = candidateMoves.filter(\r\n    (move) => !isSameColor(board, index, move)\r\n  );\r\n  return legalMoves;\r\n}\r\n\r\nfunction calculateKnightMoves(board, index) {\r\n  let candidateMoves = [];\r\n  const rank = Math.floor(index / 8);\r\n  const file = index % 8;\r\n  if (file > 0) {\r\n    if (rank > 1) candidateMoves.push(index - 17);\r\n    if (rank < 6) candidateMoves.push(index + 15);\r\n  }\r\n  if (file > 1) {\r\n    if (rank > 0) candidateMoves.push(index - 10);\r\n    if (rank < 7) candidateMoves.push(index + 6);\r\n  }\r\n  if (file < 6) {\r\n    if (rank > 0) candidateMoves.push(index - 6);\r\n    if (rank < 7) candidateMoves.push(index + 10);\r\n  }\r\n  if (file < 7) {\r\n    if (rank > 1) candidateMoves.push(index - 15);\r\n    if (rank < 6) candidateMoves.push(index + 17);\r\n  }\r\n\r\n  let legalMoves = candidateMoves.filter(\r\n    (move) => !isSameColor(board, index, move)\r\n  );\r\n\r\n  console.log(index, legalMoves);\r\n  return legalMoves;\r\n}\r\n\r\nfunction calculateQueenMoves(board, index) {\r\n  return [\r\n    ...calculateBishopMoves(board, index),\r\n    ...calculateRookMoves(board, index),\r\n  ];\r\n}\r\n\r\nfunction calculateKingMoves(board, index) {\r\n  let candidateMoves = [];\r\n  const rank = Math.floor(index / 8);\r\n  const file = index % 8;\r\n  const white = board[index] & 0b10000;\r\n  if (file > 0) {\r\n    candidateMoves.push(index - 1);\r\n    if (rank > 0) candidateMoves.push(index - 9);\r\n    if (rank < 7) candidateMoves.push(index + 7);\r\n  }\r\n  if (file < 7) {\r\n    candidateMoves.push(index + 1);\r\n    if (rank > 0) candidateMoves.push(index - 7);\r\n    if (rank < 7) candidateMoves.push(index + 9);\r\n  }\r\n  if (rank > 0) candidateMoves.push(index - 8);\r\n  if (rank < 7) candidateMoves.push(index + 8);\r\n\r\n  const legalMoves = candidateMoves.filter(\r\n    (move) => !isSameColor(board, index, move)\r\n  );\r\n\r\n  \r\n  return legalMoves;\r\n}\r\nexport function kingSquares(board, index){\r\n  const white = board[index] & 0b1000;\r\n  const candidateMoves = calculateKingMoves(board, index);\r\n  console.log(candidateMoves)\r\n  const legalMoves = candidateMoves.filter(move => { \r\n    const newBoard = [...board];\r\n    newBoard[move] = newBoard[index];\r\n    newBoard[index] = 0;\r\n    return calculateLegalMoves(newBoard, white ? \"w\": \"b\").includes(move);\r\n  })\r\n  console.log(legalMoves);\r\n  return;\r\n  // // console.log(white, legalMoves);\r\n  // const oppositeColorLegalMoves = calculateLegalMoves(board, white ? \"w\": \"b\"); \r\n  // // console.log(\"OPPOSITE COLOR MOVES: \", oppositeColorLegalMoves);\r\n  // // console.log(oppositeColorLegalMoves, legalMoves);\r\n  // const legalMovesNotInCheck = legalMoves.filter(move => !oppositeColorLegalMoves.includes(move));\r\n  // console.log(\"LEgal moves: \", legalMovesNotInCheck);\r\n  // // return legalMovesNotInCheck;\r\n}\r\n\r\nexport default calculateLegalMovesForPiece;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}